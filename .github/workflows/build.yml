name: Build & Test

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: macos-latest

    steps:
      - name: Checkout ä»£ç 
        uses: actions/checkout@v4

      - name: è®¾ç½® Xcode ç‰ˆæœ¬
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable

      - name: Debug æ„å»º
        run: |
          swift build
          echo "âœ… Debug æ„å»ºæˆåŠŸ"

      - name: Release æ„å»º
        run: |
          swift build -c release
          echo "âœ… Release æ„å»ºæˆåŠŸ"

      - name: ä»£ç æ£€æŸ¥
        run: |
          # æ£€æŸ¥ä»£ç è¡Œæ•°
          echo "ğŸ“Š ä»£ç ç»Ÿè®¡ï¼š"
          find Sources -name "*.swift" -exec wc -l {} + | tail -1

          # æ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶å¤§å°
          echo "ğŸ“¦ å¯æ‰§è¡Œæ–‡ä»¶å¤§å°ï¼š"
          ls -lh .build/arm64-apple-macosx/release/ChargingPowerTool

      - name: æ„å»ºæŠ¥å‘Š
        run: |
          echo "âœ… æ‰€æœ‰æ„å»ºä»»åŠ¡å®Œæˆ"
          echo "- Debug æ„å»º: âœ“"
          echo "- Release æ„å»º: âœ“"
